{"name":"Heliumkit","tagline":"HeliumKit, a lightweight framework that sits between your web services and the business logic of your app","body":"# HeliumKit\r\n\r\n## About\r\n\r\nHeliumKit is a lightweight framework that sits between your web services and the business logic of your app.\r\n\r\n**WARNING!** HeliumKit is still in **alpha** version and API might change any time.\r\n\r\nIt provides basic mapping to automate conversion from DTO coming from your web services into object models of your business domain. We decided to streamline the process by adopting some libraries and frameworks:\r\n\r\n- [PromiseKit](https://github.com/mxcl/PromiseKit) to manage all the async code\r\n- [FMDB](https://github.com/ccgus/fmdb) to store data in SQLite\r\n- [Mantle](https://github.com/Mantle/Mantle) to convert models to and from JSON representation\r\n- [MTLFMDBAdapter](https://github.com/tanis2000/MTLFMDBAdapter) to convert models into SQL statements to feed to FMDB\r\n- [AFNetworking](https://github.com/AFNetworking/AFNetworking) to manage web service API calls\r\n\r\nThe main focus is to keep this framework as lightweight as possible and at the same time make it flexible enough for you to craft the perfect solution to your data transfer and storage layer. Many ideas come from RestKit as I've been using that framework for commercial apps before. But I've never been fond of Core Data as the storage architecture. I'm way too used to good old SQL statements and I can't live with the threading issues that you have to fight against when using Core Data. Core Data is great, but it's not for me.\r\n\r\nHeliumKit can simply keep your data in in-memory models or it can write them to SQLite as needed. That's completely configurable. I tried to keep in mind the convention over configuration paradigm as I hate boilerplate code.\r\nI hope you find this framework just as useful as I do. Contributions and pull requests are welcome!\r\n\r\n## Introduction\r\n\r\nHeliumKit is pretty much the result of my frustration with other REST mapping frameworks and Core Data. The article [On Using SQLite and FMDB Instead of Core Data](http://www.objc.io/issue-4/SQLite-instead-of-core-data.html) by [Brent Simmons](http://inessential.com/) sums up what I think about Core Data and why I try to avoid using it whenever possible. I've also drawn inspiration from that article to come up with the [ALTDatabaseController](https://github.com/tanis2000/HeliumKit/blob/develop/Pod/Classes/Database/ALTDatabaseController.h) class. \r\n\r\n## Quick start\r\n\r\nHere's a quick example of what you can do with HeliumKit.\r\n\r\n### Your first data provider\r\n\r\nCreate a new provider to read the repository of my user from GitHub. The first thing to do is to create the model:\r\n\r\nALTGHRepo.h\r\n```obj-c\r\n#import \"MTLModel.h\"\r\n#import <Mantle/MTLJSONAdapter.h>\r\n#import <MTLFMDBAdapter/MTLFMDBAdapter.h>\r\n\r\n@interface ALTGHRepo : MTLModel<MTLJSONSerializing, MTLFMDBSerializing>\r\n\r\n@property (nonatomic, copy) NSNumber *repoId;\r\n@property (nonatomic, copy) NSString *repoName;\r\n@property (nonatomic, copy) NSString *repoUrl;\r\n\r\n@end\r\n``` \r\n\r\nALTGHRepo.m\r\n```obj-c\r\n#import \"ALTGHRepo.h\"\r\n\r\n@implementation ALTGHRepo\r\n\r\n+(NSDictionary *)JSONKeyPathsByPropertyKey {\r\n    return @{\r\n             @\"repoId\": @\"id\",\r\n             @\"repoName\": @\"name\",\r\n             @\"repoUrl\": @\"url\",\r\n             };\r\n}\r\n\r\n+(NSDictionary *)FMDBColumnsByPropertyKey {\r\n    return @{\r\n             @\"repoId\": @\"id\",\r\n             @\"repoName\": @\"name\",\r\n             @\"repoUrl\": @\"url\",\r\n             };\r\n}\r\n\r\n+(NSArray *)FMDBPrimaryKeys {\r\n    return @[@\"id\"];\r\n}\r\n\r\n+(NSString *)FMDBTableName {\r\n    return @\"ghrepo\";\r\n}\r\n@end\r\n```\r\n\r\nNext you need to create the provider itself:\r\n\r\nALTGHRepoProvider.h\r\n```obj-c\r\n#import \"ALTBaseProvider.h\"\r\n\r\n@interface ALTGHRepoProvider : ALTBaseProvider\r\n\r\n@end\r\n```\r\n\r\nALTGHRepoProvider.m\r\n```obj-c\r\n#import \"ALTGHRepoProvider.h\"\r\n#import \"ALTGHRepo.h\"\r\n#import <HeliumKit/ALTObjectMapping.h>\r\n\r\n@implementation ALTGHRepoProvider\r\n\r\n- (NSString *)endPoint {\r\n    return [NSString stringWithFormat:@\"%@%@\", self.baseURL, @\"/users/tanis2000/repos\"];\r\n}\r\n\r\n- (PMKPromise *)fetchObjectsFromDb {\r\n    return [PMKPromise new:^(PMKPromiseFulfiller fulfiller, PMKPromiseRejecter rejecter) {\r\n        if (!self.skipDatabase) {\r\n            [self.database fetch:@\"ghrepo\" returnClass:ALTGHRepo.class].then(^(id res) {\r\n                fulfiller(res);\r\n            });\r\n        } else {\r\n            fulfiller(nil);\r\n        }\r\n    }];\r\n}\r\n\r\n- (NSArray *)objectMappings {\r\n    ALTObjectMapping *mapping = [ALTObjectMapping mappingForModel:ALTGHRepo.class sourcePath:nil];\r\n    \r\n    return @[mapping];\r\n}\r\n```\r\n\r\nTo test this, add the following code to your business logic layer:\r\n\r\n```obj-c\r\nALTDatabaseController *_database;\r\nAFHTTPRequestOperationManager *_manager;\r\n\r\n_manager = [AFHTTPRequestOperationManager manager];\r\n_manager.responseSerializer = [AFJSONResponseSerializer serializer];\r\n_manager.requestSerializer = [AFJSONRequestSerializer serializer];\r\n[_manager.requestSerializer setValue:@\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36\" forHTTPHeaderField:@\"User-Agent\"];\r\n[_manager.requestSerializer setValue:@\"application/json\" forHTTPHeaderField:@\"Content-Type\"];\r\n[_manager.requestSerializer setValue:@\"application/json\" forHTTPHeaderField:@\"Accept\"];\r\n\r\n// Grab the Documents folder\r\nNSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);\r\nNSString *documentsDirectory = [paths objectAtIndex:0];\r\n\r\n// Sets the database filename\r\nNSString *filePath = [documentsDirectory stringByAppendingPathComponent:@\"Test.sqlite\"];\r\n\r\n_database = [[ALTDatabaseController alloc] initWithDatabasePath:filePath\r\n                                                  creationBlock:^(FMDatabase *db, BOOL *rollback) {\r\n                                                      [db executeUpdate:@\"create table if not exists ghrepo \"\r\n                                                       \"(id text unique, name text, url text)\"];\r\n                                                  }];\r\n\r\nALTGHRepoProvider *provider = [[ALTGHRepoProvider alloc] initWithDatabaseController:_database andRequestOperationManager:_manager andBaseURL:@\"https://api.github.com\"];\r\nALTBaseRequest *request = [[ALTBaseRequest alloc] init];\r\nprovider.request = request;\r\n[provider fetchData:ALTHTTPMethodGET].then(^(NSArray *cachedData, PMKPromise *freshData) {\r\n    // cachedData contains data already in the db\r\n    return freshData;\r\n}).then(^(id mappingResult, NSArray *freshData) {\r\n\t// freshData contains the data that has been grabbed from the remote service and saved into the database\r\n    NSLog(@\"%@\", freshData);\r\n}).catch(^(NSError *error) {\r\n    NSLog(@\"Failed with error: %@\", [error localizedDescription]);\r\n});\r\n\r\n```\r\n\r\n## Limitations\r\n\r\nHeliumKit isn't a one-stop-do-it-all solution. It does a few things pretty well but that's all there is to it. This is not a full ORM solution nor is it a complete replacement of Core Data.\r\n\r\nWhat HeliumKit does not do:\r\n\r\n- there's no support for models that are children of other models. The data being loaded from the database is an NSArray of instances of models returned by a SQL query. We're not retrieving associated models. BUT! If you work directly with the data returned by the web service, that data will contain all of the related classes as well.\r\n\r\n## Usage\r\n\r\nTo run the example project, clone the repo, and run `pod install` from the Example directory first.\r\n\r\n## Installation\r\n\r\nHeliumKit is available through [CocoaPods](http://cocoapods.org). To install\r\nit, simply add the following line to your Podfile:\r\n\r\n    pod \"HeliumKit\"\r\n\r\n## Author\r\n\r\nValerio Santinelli, santinelli@altralogica.it\r\n\r\n## License\r\n\r\nHeliumKit is available under the MIT license. See the LICENSE file for more info.\r\n\r\n","google":"UA-2312876-12","note":"Don't delete this file! It's used internally to help with page regeneration."}